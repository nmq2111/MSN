<!DOCTYPE html>
<html lang="en">
  <%- include('../partials/_head.ejs') %>

  <body class="auth-bg">
    <%- include('../partials/_pageLoader.ejs') %> <%-
    include('../partials/_navbar.ejs') %>

    <div class="page">
      <div class="page-inner">
        <div class="container-ads">
          <!-- HEADER -->
          <div class="ads-header">
            <h1 class="ads-title">My Ads</h1>

            <div class="ads-search">
              <form
                action="/Ads/<%= user._id %>/Ads"
                method="GET"
                class="ads-search-form"
              >
                <input
                  type="text"
                  name="q"
                  value="<%= typeof searchQuery !== 'undefined' ? searchQuery : '' %>"
                  id="adsSearch"
                  placeholder="Search"
                />
              </form>
            </div>

            <a class="add-ad-btn" href="/Ads/<%= user._id %>/new">
              <i class="fa fa-plus-circle"></i> Add New Ad
            </a>
          </div>

          <!-- GRID -->
          <% if (ads && ads.length) { %>
          <div class="ads-grid" id="adsGrid">
            <% ads.forEach((ad) => { %>
            <article class="ad-card">
              <!-- clickable image/title -->

              <div class="ad-card-image">
                <img src=<%= ad.imgUrl || '/images/handshake.png' %> alt="<%=
                ad.title %>" class="ad-card-img" />
              </div>

              <div class="ad-card-body">
                <span class="ad-category-badge"><%= ad.category %></span>

                <h2 class="ad-card-title"><%= ad.title %></h2>
                <p class="ad-card-price">BD <%= ad.price %></p>
                <p class="ad-card-desc"><%= ad.description %></p>

                <span
                  class="condition-badge <%= ad.condition === 'new' ? 'condition-new' : 'condition-used' %>"
                >
                  <%= ad.condition %>
                </span>
              </div>

              <!-- ACTIONS -->
              <div class="ad-actions">
                <a
                  class="edit-btn"
                  href="/Ads/<%= ad.owner._id %>/Ads/<%= ad._id %>/edit"
                >
                  Edit
                </a>

                <form
                  action="/Ads/<%= ad.owner._id %>/Ads/<%= ad._id %>?_method=DELETE"
                  method="POST"
                  class="ad-delete-form"
                >
                  <button class="btn-red" type="submit">Delete</button>
                </form>
              </div>
            </article>
            <% }) %>
          </div>
          <% } else { %>
          <p class="ads-empty">No ads in this account.</p>
          <% } %>
        </div>
      </div>
    </div>

    <%- include('../partials/_footer.ejs') %>
  </body>
</html>
